{% extends "base/chart_base.html" %}

{% block page_content%}
{% for message in get_flashed_messages() %}
  <div class="alert alert-warning">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      {{ message }}
  </div>
{% endfor %}

<div id="actualtime-temp"></div>
<div id="lastday-temp"></div>
<div id="lastweek-temp"></div>
<div id="all-temp"></div>
<!-- <div id="curweek-temp"></div> -->
{% endblock %}

{% block scripts %}
	{{ super() }}
	<script type="text/javascript">

	//后端数据
	var data = {{ data|safe }};

	//创建图表
	var chart;
	$(document).ready(function() {
	   	Highcharts.setOptions({
		    global:{
		        useUTC:false
		    }
	   })
	    chart = new Highcharts.StockChart( {
		    chart : {
			    renderTo : 'actualtime-temp',
			    type: 'spline',
			    events : {
			        load : st  // ajax定时器
			    }
		    },
		    rangeSelector: {
		        enabled: false
		    },
		    navigator: {
		    	enabled: false
		    },
		    scrollbar: {
		    	enabled: false
		    },
		    exporting:{
		    	enabled: true
		    },
		    credits:{
		    	enabled: false
		    },
		    title : {
		     	text: '实时温度监控'
		    },
		    subtitle: {
		    	useHTML: true,
		    	text: "Source: <a href='/contact' target='_blank'>Zhifeng Studio</a>"
		    },
		    xAxis: {
		    	title: {
		    		text: 'Time: Min/Sec',
		    		align: 'high'
		    	},
		    	type: 'datetime',
		    	labels: {
	                formatter: function() {
	                    return Highcharts.dateFormat('%M:%S', this.value);                  
	                }
	            },
		    	crosshair: {
	                width: 2,
	                color: 'rgba(119, 152, 191, .5)',
	                dashStyle: 'dash'
		        }
		    },
		    yAxis: {
                title: {
                    text: 'Temperature (°C)'
                },
                crosshair: {
	                width: 2,
	                color: 'rgba(119, 152, 191, .5)',
	                dashStyle: 'dash'
		        }
		    },
		    plotOptions: {
                series: {
                	marker: {
                		enabled: true,
                		radius: 4
                	}
                }
			},
		    tooltip: {
    			positioner: function(){
    				return { x: 60, y: 30};
    			},
                valueSuffix: 'ºC'
		    },
		    series : [{
			    name: 'temperature',
			    data : data
		     }]
	   });

	});
	
	</script>
	<script type="text/javascript" src="../static/js/lastdaytemp.js"></script>
	<script type="text/javascript" src="../static/js/lastweektemp.js"></script>
	<script type="text/javascript" src="../static/js/ajax_temp.js"></script>
	<script type="text/javascript" src="../static/js/all_temp.js"></script>

{% endblock %}